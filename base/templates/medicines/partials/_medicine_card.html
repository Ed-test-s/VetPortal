{% load static %}

<div class="col-12 col-sm-6 col-md-4">
  <div class="card h-100 shadow-sm position-relative">

    <!-- üîπ –ö–Ω–æ–ø–∫–∞ "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ" -->
    {% if user.is_authenticated %}
      <button
        class="btn btn-light position-absolute top-0 end-0 m-2 rounded-circle shadow-sm toggle-favorite"
        data-id="{{ med.id }}"
        data-url="{% url 'toggle_favorite' med.id %}">
        {% if med.is_favorite %}
          <i class="bi bi-heart-fill text-danger"></i>
        {% else %}
          <i class="bi bi-heart"></i>
        {% endif %}
      </button>
    {% endif %}

    <!-- –§–æ—Ç–æ -->
    {% if med.main_image %}
      <img src="{{ med.main_image.url }}" class="card-img-top object-fit-cover" style="height:300px;" alt="{{ med.name }}">
    {% else %}
      <img src="{% static 'images/no-image.png' %}" class="card-img-top object-fit-cover" style="height:300px;" alt="–ù–µ—Ç —Ñ–æ—Ç–æ">
    {% endif %}

    <!-- –ò–Ω—Ñ–æ -->
    <div class="card-body d-flex flex-column">
      <h5 class="card-title mb-2 text-truncate">
        <a href="{% url 'medicine_detail' med.slug %}" class="text-decoration-none text-dark d-inline-block w-100">
          {{ med.name }}
        </a>
      </h5>

      {% if med.category %}
        <p class="text-muted small mb-2 text-truncate">
          –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ med.category.name }}
        </p>
      {% endif %}

      <p class="text-success fw-bold mb-2">
        {% if med.get_min_price %}
          –û—Ç {{ med.get_min_price }} —Ä.
        {% else %}
          –ù–µ—Ç –≤ –ø—Ä–æ–¥–∞–∂–µ
        {% endif %}
      </p>

      <!-- üîπ –ü–æ–¥—Ä–æ–±–Ω–µ–µ -->
      <a href="{% url 'medicine_detail' med.slug %}" class="btn btn-primary mt-auto">
        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
      </a>
    </div>
  </div>
</div>
